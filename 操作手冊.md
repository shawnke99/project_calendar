# 專案行事曆系統 - 操作手冊

## 目錄
1. [系統概述](#系統概述)
2. [快速開始](#快速開始)
3. [主要功能](#主要功能)
4. [操作步驟](#操作步驟)
5. [功能詳解](#功能詳解)
6. [常見問題](#常見問題)
7. [注意事項](#注意事項)

---

## 系統概述

### 系統簡介
專案行事曆系統是一個用於管理與顯示多個環境工作任務的視覺化管理工具。系統以月曆形式呈現，支援階層式任務結構，並能同時顯示多個環境的並行工作項目。

### 主要特色
- 📅 **月曆視圖**：直觀的月份行事曆顯示
- 🎨 **顏色編碼**：不同環境使用不同顏色區分
- 🔍 **環境篩選**：可選擇顯示特定環境
- ⚙️ **顯示設定**：自訂任務條顯示欄位
- 📊 **階層結構**：環境 → 梯次 → 工作項目

### 系統架構
```
環境（第一階層）
├── 環境名稱
├── 環境目的（根據「環境名稱 + 執行梯次」決定）
└── 工作項目（第二階層）
    ├── 執行梯次
    ├── 狀態
    └── 工作內容
```

---

## 快速開始

### 步驟 1：啟動系統

**方法一：使用 HTTP Server（推薦）**
```bash
npx http-server . -p 8080 -o
```

**方法二：使用 npm**
```bash
npm start
```

### 步驟 2：開啟瀏覽器
- 系統會自動開啟瀏覽器
- 或手動訪問：`http://localhost:8080`

### 步驟 3：確認資料載入
- 系統會自動載入 Excel 檔案
- 確認月曆中顯示任務資料

---

## 主要功能

### 1. 月曆視圖
- 顯示當月所有日期
- 今天日期以特殊樣式標示
- 跨日期任務以橫條形式顯示

### 2. 環境篩選
- 頂部環境篩選按鈕
- 可選擇顯示特定環境
- 支援「全部顯示」選項

### 3. 顯示設定
- 自訂任務條顯示欄位
- 可選擇顯示：環境名稱、執行梯次、狀態、環境目的、營業日等
- 設定自動保存

### 4. 任務詳情
- 點擊日期或任務查看完整資訊
- 顯示所有相關欄位資料

### 5. 月份切換
- 使用「上個月」/「下個月」按鈕
- 保持篩選狀態

---

## 操作步驟

### 操作 1：查看月曆

**位置**：頁面中央的月曆區域

**步驟**：
1. 系統載入後自動顯示當前月份
2. 查看當月所有日期
3. 今天日期會以特殊樣式標示（建議截圖：顯示今天日期的樣式）

**說明**：
- 每個日期格子可顯示多個任務
- 跨日期任務以橫條形式顯示
- 不同環境使用不同顏色區分

---

### 操作 2：切換月份

**位置**：頁面頂部，標題列右側

**按鈕**：
- 「◀ 上個月」按鈕
- 「下個月 ▶」按鈕
- 中間顯示當前月份（例如：「2026年1月」）

**步驟**：
1. 點擊「◀ 上個月」查看上一個月
2. 點擊「下個月 ▶」查看下一個月
3. 月份切換時保持環境篩選狀態

**建議截圖**：標題列區域，顯示月份切換按鈕

---

### 操作 3：環境篩選

**位置**：月曆上方，「環境篩選」區域

**步驟**：
1. 查看「環境篩選」區域
2. 點擊「全部顯示」按鈕顯示所有環境
3. 點擊特定環境按鈕（例如：「IT準備」）只顯示該環境
4. 當前選中的環境按鈕會以不同樣式顯示

**說明**：
- 預設顯示所有環境
- 篩選後只顯示選中環境的任務
- 月份切換時保持篩選狀態

**建議截圖**：環境篩選區域，顯示多個環境按鈕

---

### 操作 4：查看任務詳情

**方法一：點擊日期**
1. 點擊月曆中的日期格子
2. 彈出「任務詳情」視窗
3. 顯示該日期的所有任務資訊

**方法二：點擊任務條**
1. 點擊任務條（跨日期顯示的橫條）
2. 彈出「任務詳情」視窗
3. 顯示該任務的完整資訊

**任務詳情視窗內容**：
- 環境名稱
- 環境目的
- 執行梯次
- 狀態
- 日期範圍（開始日期 至 結束日期）
- 工作內容
- 營業日
- 資料基準日
- 京城封版日
- 京城傳送中介檔日
- 中介檔
- 備注說明

**關閉視窗**：
- 點擊右上角的「×」按鈕
- 點擊視窗外部
- 按 ESC 鍵

**建議截圖**：任務詳情視窗，顯示完整的任務資訊

---

### 操作 5：顯示設定

**位置**：頁面頂部，標題列右側，「⚙️ 顯示設定」按鈕

**步驟**：
1. 點擊「⚙️ 顯示設定」按鈕
2. 彈出「顯示設定」面板
3. 在「任務條顯示設定」區域中：
   - 勾選要顯示的欄位
   - 取消勾選要隱藏的欄位
4. 點擊「套用」按鈕保存設定
5. 點擊「重置為預設」按鈕恢復預設設定
6. 點擊右上角的「×」按鈕關閉面板

**可設定的欄位**：
- ✅ 環境名稱（預設顯示，建議保持勾選）
- ✅ 執行梯次（預設顯示）
- ✅ 狀態（預設顯示）
- ✅ 環境目的（預設顯示）
- ⬜ 營業日
- ⬜ 工作內容
- ⬜ 開始日期
- ⬜ 結束日期
- ⬜ 資料基準日
- ⬜ 京城封版日
- ⬜ 京城傳送中介檔日
- ⬜ 中介檔
- ⬜ 備注說明

**說明**：
- 設定會自動保存到瀏覽器本地儲存
- 下次開啟時會自動載入上次的設定
- 任務條上會根據設定顯示對應的欄位標籤

**建議截圖**：顯示設定面板，顯示所有可勾選的欄位

---

### 操作 6：重新讀取 Excel 檔案

**位置**：頁面頂部，標題列右側，「📄 重新讀取」按鈕

**步驟**：
1. 確認 Excel 檔案已更新
2. 點擊「📄 重新讀取」按鈕
3. 系統會重新載入 Excel 檔案
4. 月曆會更新顯示最新資料

**說明**：
- 用於 Excel 檔案更新後重新載入資料
- 不會清除顯示設定和篩選狀態

---

### 操作 7：清除快取

**位置**：頁面頂部，標題列右側，「🔄 清除快取」按鈕

**步驟**：
1. 點擊「🔄 清除快取」按鈕
2. 系統會清除瀏覽器快取
3. 頁面會自動重新載入

**使用時機**：
- 修改了 JavaScript 或 CSS 檔案後
- 更新了版本號後
- 遇到顯示異常時

**說明**：
- 會清除 localStorage 和 sessionStorage
- 會清除 Cache API 快取
- 使用時間戳確保載入最新檔案

---

## 功能詳解

### 環境目的說明

**重要概念**：環境目的會根據「環境名稱 + 執行梯次」來決定

**範例**：
- 「IT準備」+「平測第一次」→ 環境目的為「IT前置準備-平測」
- 「IT準備」+「其他梯次」→ 環境目的可能為其他值

**意義**：
- 同一環境的不同梯次可以有不同的環境目的
- 系統會根據每筆記錄的「環境名稱 + 執行梯次」組合來決定該組合的環境目的

---

### 任務條顯示

**預設顯示欄位**：
- 環境名稱（主要識別，建議保持顯示）
- 執行梯次
- 狀態
- 環境目的

**可選顯示欄位**：
- 營業日（橙色標籤）
- 工作內容（紫色標籤）
- 開始日期（綠色標籤）
- 結束日期（紅色標籤）
- 其他擴展欄位

**顏色標識**：
- 不同欄位使用不同顏色的標籤顯示
- 顏色配置可在圖例中查看

---

### 圖例說明

**位置**：頁面底部，「圖例說明」區域

**內容**：
1. **環境圖例**：顯示所有環境及其對應顏色
2. **梯次圖例**：顯示所有執行梯次及其對應顏色
3. **狀態圖例**：顯示所有狀態及其對應顏色
4. **任務條顯示欄位圖例**：顯示已啟用的任務條欄位及其顏色

**說明**：
- 圖例會根據顯示設定動態更新
- 只顯示已啟用的欄位

---

### 非工作日說明

**位置**：頁面底部，「非工作日說明」區域

**內容**：
- 顯示所有非工作日及其說明
- 包括週末和自訂假日

**說明**：
- 非工作日在月曆中會以不同背景色顯示
- 配置可在 `js/config.js` 中修改

---

## 常見問題

### Q1：無法載入 Excel 檔案

**可能原因**：
1. 檔案路徑不正確
2. 使用直接開啟檔案而非 HTTP Server
3. 檔案格式不正確

**解決方法**：
1. 確認檔案路徑：`resource/範例_藍圖之對應時程環境規劃.xlsx`
2. 使用 HTTP Server 啟動（不要直接開啟 HTML 檔案）
3. 檢查瀏覽器控制台的錯誤訊息
4. 確認 Excel 檔案格式符合要求

---

### Q2：環境目的顯示錯誤

**可能原因**：
1. 不了解環境目的根據「環境名稱 + 執行梯次」決定
2. Excel 中環境目的欄位資料不正確

**解決方法**：
1. 確認環境目的會根據「環境名稱 + 執行梯次」來決定
2. 檢查 Excel 中同一「環境+梯次」組合的環境目的是否一致
3. 確認 Excel 中有正確的「環境目的」欄位

---

### Q3：任務條顯示欄位不正確

**可能原因**：
1. 顯示設定未正確保存
2. 瀏覽器本地儲存被清除

**解決方法**：
1. 重新設定顯示欄位
2. 點擊「套用」按鈕保存設定
3. 檢查瀏覽器是否允許本地儲存
4. 清除快取後重新設定

---

### Q4：顏色顯示異常

**可能原因**：
1. CSS 檔案未正確載入
2. 瀏覽器快取問題

**解決方法**：
1. 點擊「清除快取」按鈕
2. 重新載入頁面
3. 檢查瀏覽器控制台是否有錯誤

---

### Q5：月份切換後資料消失

**可能原因**：
1. 該月份沒有任務資料
2. 環境篩選導致資料被隱藏

**解決方法**：
1. 檢查該月份是否有任務資料
2. 點擊「全部顯示」按鈕查看所有環境
3. 檢查 Excel 檔案中的日期範圍

---

## 注意事項

### Excel 檔案格式

1. **必填欄位**：
   - 環境名稱
   - 工作內容
   - 驗證起日（開始日期）

2. **選填欄位**：
   - 環境目的（未填寫時顯示「未指定目的」）
   - 驗證迄日（未填寫時使用驗證起日）
   - 執行梯次
   - 狀態

3. **環境目的**：
   - 環境目的會根據「環境名稱 + 執行梯次」來決定
   - 同一環境的不同梯次可以有不同的環境目的

4. **日期格式**：
   - 支援 Excel 日期序列號（推薦）
   - 支援 YYYY-MM-DD、YYYY/MM/DD 等格式

### 瀏覽器相容性

- 建議使用現代瀏覽器（Chrome、Firefox、Edge、Safari）
- 不建議使用 IE 瀏覽器

### 資料更新

- 更新 Excel 檔案後，點擊「重新讀取」按鈕重新載入
- 修改 JavaScript 或 CSS 檔案後，點擊「清除快取」按鈕重新載入

### 版本號管理

- 版本號直接在 HTML 中手動設置
- 修改 `index.html` 中的 `?v=xx` 參數
- 更新版本號後，點擊「清除快取」按鈕重新載入

---

## 操作流程圖

### 基本操作流程

```
啟動系統
  ↓
載入 Excel 檔案
  ↓
顯示月曆視圖
  ↓
選擇操作：
  ├─ 切換月份
  ├─ 環境篩選
  ├─ 顯示設定
  ├─ 查看任務詳情
  ├─ 重新讀取檔案
  └─ 清除快取
```

### 顯示設定流程

```
點擊「顯示設定」按鈕
  ↓
開啟顯示設定面板
  ↓
勾選/取消勾選欄位
  ↓
點擊「套用」按鈕
  ↓
保存設定到本地儲存
  ↓
更新任務條顯示
  ↓
更新圖例說明
```

---

## 功能對照表

| 功能 | 位置 | 按鈕/區域 | 說明 |
|------|------|----------|------|
| 切換月份 | 標題列 | ◀ 上個月 / 下個月 ▶ | 切換顯示月份 |
| 環境篩選 | 環境篩選區域 | 環境按鈕 | 選擇顯示特定環境 |
| 顯示設定 | 標題列 | ⚙️ 顯示設定 | 自訂任務條顯示欄位 |
| 重新讀取 | 標題列 | 📄 重新讀取 | 重新載入 Excel 檔案 |
| 清除快取 | 標題列 | 🔄 清除快取 | 清除快取並重新載入 |
| 查看詳情 | 月曆區域 | 點擊日期/任務 | 查看任務完整資訊 |
| 圖例說明 | 頁面底部 | 圖例說明區域 | 查看顏色對應關係 |

---

## 快捷鍵

| 按鍵 | 功能 |
|------|------|
| ESC | 關閉任務詳情視窗或顯示設定面板 |

---

## 系統要求

### 環境要求
- 現代瀏覽器（Chrome、Firefox、Edge、Safari）
- 支援 JavaScript
- 支援本地儲存（localStorage）

### 檔案要求
- Excel 檔案格式：`.xlsx`
- 檔案位置：`resource/範例_藍圖之對應時程環境規劃.xlsx`

---

## 技術支援

### 檢查項目
1. 瀏覽器控制台的錯誤訊息
2. Excel 檔案格式是否符合規範
3. 網路連線是否正常（用於載入 CDN 資源）
4. 瀏覽器是否允許本地儲存

### 相關文件
- `README.md` - 專案概述
- `CONFIG_GUIDE.md` - 配置指南
- `EXCEL_FORMAT.md` - Excel 格式說明
- `USAGE.md` - 使用說明

---

## 附錄：建議截圖位置

### 截圖 1：系統主畫面
**內容**：完整的月曆視圖，顯示多個環境的任務

### 截圖 2：標題列
**內容**：月份切換按鈕、重新讀取按鈕、清除快取按鈕、顯示設定按鈕

### 截圖 3：環境篩選區域
**內容**：環境篩選按鈕，顯示多個環境選項

### 截圖 4：顯示設定面板
**內容**：顯示設定面板，顯示所有可勾選的欄位

### 截圖 5：任務詳情視窗
**內容**：任務詳情視窗，顯示完整的任務資訊

### 截圖 6：圖例說明區域
**內容**：圖例說明，顯示環境、梯次、狀態的顏色對應

### 截圖 7：任務條顯示
**內容**：任務條上顯示的各種欄位標籤（環境名稱、執行梯次、狀態、環境目的等）

---

## 版本資訊

- **系統版本**：v1.0
- **最後更新**：2026年
- **文件版本**：v1.0

---

**注意**：本操作手冊基於系統現況編寫，如有功能更新，請參考最新版本的相關文件。
