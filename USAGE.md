# 使用說明

## 快速開始

### 方法一：使用 HTTP Server（推薦）

1. 安裝 Node.js（如果尚未安裝）
2. 在專案目錄下執行：
```bash
npx http-server . -p 8080 -o
```
或
```bash
npm start
```

3. 瀏覽器會自動開啟，或手動訪問 `http://localhost:8080`

### 方法二：使用 Python HTTP Server

```bash
# Python 3
python3 -m http.server 8080

# Python 2
python -m SimpleHTTPServer 8080
```

然後在瀏覽器中訪問 `http://localhost:8080`

### 方法三：直接開啟（可能有限制）

由於瀏覽器的安全限制，直接開啟 `index.html` 可能無法讀取 Excel 檔案。建議使用上述的 HTTP Server 方法。

## 功能說明

### 月曆視圖
- 顯示當月的所有日期
- 今天日期會以特殊樣式標示
- 點擊日期可查看該日所有任務詳情
- 跨日期任務以橫條形式顯示

### 環境篩選
- 使用頂部的環境篩選按鈕
- 點擊「全部顯示」可顯示所有環境
- 點擊特定環境按鈕可只顯示該環境的任務
- 月份切換時保持篩選狀態

### 任務顯示
- **第一階層**：環境名稱與目的（以粗邊框和顏色標示）
  - 環境目的會根據「環境名稱 + 執行梯次」來決定
  - 同一環境的不同梯次可以有不同的環境目的
- **第二階層**：具體工作內容（縮排顯示）
- 不同環境使用不同顏色區分
- 點擊任務項目可查看詳細資訊

### 顯示設定
- 點擊「顯示設定」按鈕（⚙️ 圖示）
- 在彈出的設定面板中，可以選擇要在任務條上顯示的欄位：
  - 環境名稱（預設顯示）
  - 執行梯次（預設顯示）
  - 狀態（預設顯示）
  - 環境目的（預設顯示）
  - 營業日
  - 工作內容
  - 開始日期
  - 結束日期
  - 資料基準日
  - 京城封版日
  - 京城傳送中介檔日
  - 中介檔
  - 備注說明
- 點擊「套用」按鈕保存設定
- 點擊「重置為預設」按鈕恢復預設設定
- 設定會自動保存到瀏覽器本地儲存

### 互動功能
- **月份切換**：使用「上個月」/「下個月」按鈕
- **任務詳情**：點擊日期或任務項目查看完整資訊
- **彈窗關閉**：點擊 X 按鈕或彈窗外部，或按 ESC 鍵
- **重新讀取**：點擊「重新讀取」按鈕重新載入 Excel 檔案
- **清除快取**：點擊「清除快取」按鈕清除瀏覽器快取並重新載入頁面

## Excel 檔案格式要求

Excel 檔案應包含以下欄位（欄位名稱可包含關鍵字）：

- **環境名稱**：欄位名稱可包含「環境」、「環境名稱」等關鍵字
- **環境目的**：欄位名稱可包含「目的」、「環境目的」、「用途」等關鍵字
  - **重要**：環境目的會根據「環境名稱 + 執行梯次」來決定
- **工作內容**：欄位名稱可包含「工作」、「工作內容」、「任務」等關鍵字
- **開始日期**：欄位名稱可包含「開始」、「開始日期」、「驗證起日」等關鍵字
- **結束日期**：欄位名稱可包含「結束」、「結束日期」、「驗證迄日」等關鍵字（可選）
- **執行梯次**：欄位名稱可包含「梯次」、「執行梯次」、「批次」等關鍵字（可選）
- **狀態**：欄位名稱可包含「狀態」、「進度」等關鍵字（可選）
- **營業日**：欄位名稱可包含「營業日」、「營業日期」等關鍵字（可選）

詳細格式說明請參考 `EXCEL_FORMAT.md`

### 日期格式支援
- Excel 日期序列號
- YYYY-MM-DD 或 YYYY/MM/DD
- MM-DD-YYYY 或 MM/DD/YYYY
- 標準日期字串

## 版本號管理

版本號直接在 HTML 中手動設置，修改 `index.html` 中的 `?v=xx` 參數即可：

```html
<script src="js/config.js?v=5"></script>
<script src="js/main.js?v=30"></script>
```

需要更新版本號時：
1. 直接修改 HTML 中的版本號參數
2. 點擊「清除快取」按鈕重新載入頁面

## 疑難排解

### 無法載入 Excel 檔案
- 確認檔案路徑正確：`resource/範例_藍圖之對應時程環境規劃.xlsx`
- 確認使用 HTTP Server 而非直接開啟檔案
- 檢查瀏覽器控制台是否有錯誤訊息

### 資料顯示不正確
- 檢查 Excel 檔案格式是否符合要求
- 確認欄位名稱包含必要的關鍵字
- 檢查日期格式是否正確
- **環境目的顯示錯誤**：確認環境目的會根據「環境名稱 + 執行梯次」來決定

### 樣式顯示異常
- 確認所有 CSS 檔案已正確載入
- 清除瀏覽器快取後重新載入（點擊「清除快取」按鈕）

### 顯示設定不生效
- 確認已點擊「套用」按鈕保存設定
- 檢查瀏覽器是否允許本地儲存
- 清除瀏覽器快取後重新載入

## 技術支援

如有問題，請檢查：
1. 瀏覽器控制台的錯誤訊息
2. Excel 檔案格式是否符合規範（參考 `EXCEL_FORMAT.md`）
3. 系統配置是否正確（參考 `CONFIG_GUIDE.md`）
4. 網路連線是否正常（用於載入 CDN 資源）
