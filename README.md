# 專案行事曆 - 任務顯示管理系統

## 專案概述

本專案旨在建立一個專案行事曆系統，用於管理與顯示多個環境的工作任務。系統以月曆形式呈現，支援階層式任務結構，並能同時顯示多個環境的並行工作項目。

## 功能需求

### 核心功能

1. **月曆視圖顯示**
   - 採用月份為單位的行事曆格式
   - 支援月份切換（上一個月/下一個月）
   - 顯示當月所有日期

2. **階層式任務結構**
   - **第一階層**：環境名稱與目的
     - 環境名稱（例如：開發環境、測試環境、生產環境等）
     - 環境目的說明
   - **第二階層**：對應的工作內容
     - 具體的工作項目
     - 工作描述與細節

3. **多環境並行顯示**
   - 同一時間可能有多個環境同時進行工作
   - 需要清楚區分不同環境的任務
   - 避免視覺混亂，確保可讀性

4. **Excel 資料來源**
   - 從 `resource/藍圖之對應時程環境規劃_v0.1.xlsx` 讀取資料
   - 解析 Excel 檔案中的環境與工作項目資訊
   - 支援日期、環境、工作內容等欄位

## 資料結構規格

### Excel 檔案預期格式

Excel 檔案應包含以下欄位：

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 環境名稱 | 第一階層：環境識別名稱 | 開發環境、測試環境 |
| 環境目的 | 第一階層：該環境的用途說明 | 功能開發與驗證 |
| 工作內容 | 第二階層：具體工作項目 | 實作登入功能、撰寫測試案例 |
| 開始日期 | 工作項目的開始日期 | 2024-01-15 |
| 結束日期 | 工作項目的結束日期 | 2024-01-20 |
| 狀態 | 工作項目狀態（可選） | 進行中、已完成、待開始 |

### 資料階層關係

```
環境（第一階層）
├── 環境名稱
├── 環境目的
└── 工作項目（第二階層）
    ├── 工作內容 1
    ├── 工作內容 2
    └── ...
```

## UI/UX 設計要求

### 視覺呈現原則

1. **月曆版面**
   - 採用標準月曆網格布局（7 天 × 週數）
   - 每個日期格子可容納多個任務項目
   - 清楚標示今天日期

2. **多環境區分**
   - **顏色編碼**：不同環境使用不同顏色標識
     - 建議使用柔和且對比明顯的色系
     - 提供圖例說明顏色對應關係
   - **視覺層次**：
     - 第一階層（環境）使用較粗的邊框或背景色塊
     - 第二階層（工作內容）使用較細的邊框或標籤樣式
   - **分組顯示**：
     - 同一環境的任務項目視覺上聚集在一起
     - 使用縮排或連接線表示階層關係

3. **可讀性優化**
   - **文字大小**：確保在月曆格子中文字清晰可讀
   - **文字截斷**：過長的工作內容使用省略號，滑鼠懸停顯示完整內容
   - **日期範圍顯示**：跨多日的任務以橫條形式顯示
   - **重疊處理**：同一天多個任務時，使用堆疊或分欄顯示

4. **互動功能**
   - 點擊任務項目可顯示詳細資訊（環境目的、完整工作內容等）
   - 支援篩選功能：可選擇顯示特定環境
   - 月份切換時保持篩選狀態

## 技術規格

### 技術棧建議

- **前端框架**：HTML5 + CSS3 + JavaScript（或使用 React/Vue.js 等框架）
- **Excel 解析**：
  - 使用 `xlsx` 或 `exceljs` 等 JavaScript 函式庫
  - 或使用後端 API（Node.js + Express）解析 Excel 後提供 JSON 資料
- **月曆元件**：
  - 可使用現成的月曆函式庫（如 FullCalendar、Calendar.js）
  - 或自行實作客製化月曆元件

### 檔案結構建議

```
project_calendar/
├── README.md
├── index.html              # 主頁面
├── css/
│   └── calendar.css        # 月曆樣式
├── js/
│   ├── excel-reader.js     # Excel 讀取邏輯
│   ├── calendar.js         # 月曆渲染邏輯
│   └── data-processor.js   # 資料處理邏輯
├── resource/
│   └── 藍圖之對應時程環境規劃_v0.1.xlsx
└── package.json            # 依賴管理（如使用 Node.js）
```

### 資料處理流程

1. **讀取 Excel**
   - 載入 `resource/藍圖之對應時程環境規劃_v0.1.xlsx`
   - 解析工作表內容

2. **資料轉換**
   - 將 Excel 資料轉換為 JSON 格式
   - 建立環境與工作項目的階層關係
   - 按日期分組整理

3. **月曆渲染**
   - 根據當前月份生成月曆網格
   - 將任務項目對應到對應日期
   - 套用視覺樣式（顏色、階層標示）

4. **互動處理**
   - 處理月份切換事件
   - 處理任務點擊事件
   - 處理環境篩選事件

## 實作建議

### 階段一：基礎功能
1. 實作 Excel 讀取功能
2. 建立基本的月曆顯示
3. 將資料對應到日期

### 階段二：視覺優化
1. 實作環境顏色編碼
2. 優化多任務並行顯示
3. 實作階層視覺標示

### 階段三：互動功能
1. 實作任務詳細資訊彈窗
2. 實作環境篩選功能
3. 實作月份切換功能

### 階段四：優化與測試
1. 處理邊界情況（跨月任務、大量任務等）
2. 響應式設計（支援不同螢幕尺寸）
3. 效能優化

## 注意事項

1. **Excel 檔案格式**：需確認 Excel 檔案的實際欄位結構，可能需要調整解析邏輯
2. **日期格式**：需處理不同的日期格式（如：2024/1/15、2024-01-15 等）
3. **瀏覽器相容性**：Excel 讀取功能需考慮瀏覽器相容性，可能需要後端支援
4. **資料更新**：當 Excel 檔案更新時，需重新載入資料

## 未來擴充功能（可選）

- 任務狀態管理（拖曳改變日期）
- 匯出功能（匯出為 PDF 或圖片）
- 多月份視圖（季度視圖、年度視圖）
- 任務搜尋功能
- 任務統計報表
