# Excel 檔案格式說明

## 檔案位置

範例檔案已建立於：`resource/範例_藍圖之對應時程環境規劃.xlsx`

## 欄位說明

Excel 檔案應包含以下欄位（欄位名稱需包含關鍵字）：

| 欄位 | 說明 | 關鍵字範例 | 必填 | 備註 |
|------|------|-----------|------|------|
| **環境名稱** | 第一階層：環境識別名稱 | 環境、環境名稱、環境名 | ✅ | 系統主要分組依據 |
| **環境目的** | 第一階層：該環境的用途說明 | 目的、環境目的、用途 | ⚠️ | 未填寫時顯示「未指定目的」<br>**重要**：環境目的會根據「環境名稱 + 執行梯次」來決定 |
| **執行梯次** | 執行批次或階段 | 梯次、執行梯次、批次 | ❌ | 用於分組和顏色標識 |
| **驗證起日** | 工作項目的開始日期 | 開始、開始日期、驗證起日、起日 | ✅ | 用於計算日期範圍 |
| **驗證迄日** | 工作項目的結束日期 | 結束、結束日期、驗證迄日、迄日 | ⚠️ | 未填寫時使用起日 |
| **工作內容** | 第二階層：具體工作項目 | 工作、工作內容、任務、工作項目 | ✅ | 顯示在詳情中 |
| **狀態** | 工作項目狀態 | 狀態、進度、完成狀態 | ❌ | 用於顏色標識和排序 |
| **營業日** | 營業日期 | 營業日、營業日期 | ❌ | 顯示在詳情中 |
| **中介檔** | 中介檔案名稱 | 中介檔、中介檔欄位、中介檔案 | ❌ | 顯示在詳情中 |
| **資料基準日** | 資料基準日期 | 資料基準日、基準日、資料基準日期 | ❌ | 顯示在詳情中 |
| **京城封版日** | 京城封版日期 | 京城封版日、封版日、京城封版日期 | ❌ | 顯示在詳情中 |
| **京城傳送中介檔日** | 京城傳送中介檔日期 | 京城傳送中介檔日、傳送中介檔日、傳送日 | ❌ | 顯示在詳情中 |
| **備注說明** | 備注或說明文字 | 備注說明、備註說明、備注、備註、說明 | ❌ | 顯示在詳情中 |

## 環境目的說明

**重要**：環境目的會根據「環境名稱 + 執行梯次」來決定，而不是只根據環境名稱。

例如：
- 「IT準備」+「平測第一次」→ 環境目的為「IT前置準備-平測」
- 「IT準備」+「其他梯次」→ 環境目的可能為其他值

這意味著：
1. 同一環境的不同梯次可以有不同的環境目的
2. 系統會根據每筆記錄的「環境名稱 + 執行梯次」組合來決定該組合的環境目的
3. 如果 Excel 中沒有「環境目的」欄位，系統會使用「未指定目的」作為預設值

## 範例資料結構

### IT準備環境

```
環境名稱: IT準備
├── 執行梯次: 平測第一次
│   ├── 環境目的: IT前置準備-平測（根據「IT準備 + 平測第一次」決定）
│   ├── 驗證起日: 2026-05-04
│   ├── 驗證迄日: 2026-05-08
│   └── 工作項目:
│       └── IT前置準備之1.永豐BSP確認接收日
└── 執行梯次: 其他梯次
    ├── 環境目的: 其他目的（根據「IT準備 + 其他梯次」決定）
    └── ...
```

### 資轉驗證環境

```
環境名稱: 資轉驗證環境
├── 執行梯次: 第一梯次
│   ├── 環境目的: 資料轉換驗證與測試
│   ├── 驗證起日: 2024-01-15
│   ├── 驗證迄日: 2024-01-20
│   └── 工作項目:
│       ├── IT前置準備之1.永豐BSP確認接收日
│       ├── IT前置準備之2.永豐BSP DB倒檔
│       └── IT前置準備之3.永豐BSP AP確認
└── 執行梯次: 第二梯次
    ├── 環境目的: 資料轉換驗證與測試
    ├── 驗證起日: 2024-01-22
    ├── 驗證迄日: 2024-01-27
    └── 工作項目:
        ├── IT前置準備之1.永豐BSP確認接收日
        ├── IT前置準備之2.永豐BSP DB倒檔
        └── IT前置準備之3.永豐BSP AP確認
```

## 日期格式

支援以下日期格式：

- **Excel 日期序列號**（推薦）
- **YYYY-MM-DD**（例如：2024-01-15）
- **YYYY/MM/DD**（例如：2024/01/15）
- **MM-DD-YYYY**（例如：01-15-2024）
- **MM/DD/YYYY**（例如：01/15/2024）

## 資料填寫注意事項

1. **環境名稱**：每個環境應有唯一的名稱
2. **環境目的**：
   - 如果未填寫，系統會自動設為「未指定目的」
   - 環境目的會根據「環境名稱 + 執行梯次」來決定
   - 同一環境的不同梯次可以有不同的環境目的
3. **工作內容**：每個工作項目應為獨立的一列
4. **日期**：建議使用 Excel 的日期格式，避免使用文字格式
5. **空值處理**：
   - 如果「驗證迄日」為空，系統會使用「驗證起日」作為結束日期
   - 如果「狀態」為空，系統會設為「未指定」

## 範例檔案內容

範例檔案包含：

- **多個環境**：IT準備、資轉驗證環境、平測切轉環境等
- **多個執行梯次**：每個環境可能有不同的梯次
- **多筆工作項目**：每個梯次包含多個工作項目

## 使用範例檔案測試

1. 確認檔案路徑：`resource/範例_藍圖之對應時程環境規劃.xlsx`
2. 啟動網頁伺服器：
```bash
npx http-server . -p 8080 -o
```
3. 在瀏覽器中訪問 `http://localhost:8080`
4. 系統會自動載入範例資料

## 自訂資料

您可以參考範例檔案的格式，建立自己的 Excel 檔案：

1. 第一列為標題列（欄位名稱）
2. 從第二列開始為資料列
3. 每個工作項目為一列
4. 同一環境的不同工作項目可以有多列，環境名稱和目的可以重複
5. **重要**：環境目的會根據「環境名稱 + 執行梯次」來決定，請確保每筆記錄都有正確的環境目的

## 欄位映射

系統會根據欄位名稱中的關鍵字自動匹配欄位，支援的關鍵字請參考 `CONFIG_GUIDE.md` 中的 `fieldMapping` 配置。

如果您的 Excel 欄位名稱與系統預設的關鍵字不同，可以在 `js/config.js` 中的 `fieldMapping` 添加對應的關鍵字。
